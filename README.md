# GPT-4 Code Review GitHub Action

Automate your code reviews using GPT-4 to ensure TypeScript code adheres to best practices, focusing on exposed secrets, performance optimizations, code readability, and clean code principles.

## Overview
`gpt-review-action` leverages OpenAI's GPT-4 API to analyze Git diffs in your TypeScript repositories. The action automatically generates insightful feedback on your pull requests, helping teams maintain clean, performant, and secure code.

## Features
- **Code Diff Analysis**: Analyzes Git diffs for added, modified, and renamed files.
- **Exposed Secrets Detection**: Highlights any secrets or sensitive data exposed.
- **Performance Review**: Identifies performance bottlenecks and suggests optimizations.
- **Readability & Clean Code**: Ensures code readability and adherence to TypeScript clean code principles.
- **Best Practices**: Detects violations of TypeScript and modern coding standards.
- **Actionable Suggestions**: Proposes solutions like improved algorithms or design patterns.

## Inputs
| Name                  | Required | Description                                                                 |
|-----------------------|----------|-----------------------------------------------------------------------------|
| `diff-file-path`      | ‚úÖ       | Path to the Git diff file to analyze.                                       |
| `openai-api-key`      | ‚úÖ       | Your OpenAI API key for GPT-4 access.                                       |
| `github-token`        | ‚úÖ       | GitHub token to post comments on pull requests.                            |
| `prompt`              | ‚úÖ       | Code review prompt defining review focus areas.                            |
| `model`               | ‚úÖ       | OpenAI model to use (e.g., `gpt-4o`).                                      |

## Prerequisites
Before using this action, ensure you have the following:
1. **OpenAI API Key**: Obtain a valid GPT-4 API key.
2. **GitHub Secrets**:
   - `AUTO_REVIEW_CODE_TOKEN`: Token with permission to post comments.
   - `OPENAI_API_KEY`: Your GPT-4 API key.
3. **GitHub Variables**:
   - `CODE_REVIEW_PROMPT`: The review prompt that defines review criteria.
4. A GitHub repository configured for pull requests.

## Example Usage
Add the following GitHub Actions workflow to your repository:

### `.github/workflows/code-review.yml`
```yaml
name: vHandicap Code Reviewer

on:
  pull_request:

permissions:
  contents: read
  issues: write
  pull-requests: write

jobs:
  code_review:
    runs-on: ubuntu-latest

    env:
      VHANDICAP_LIB_NPM_TOKEN: ${{ secrets.VHANDICAP_LIB_NPM_TOKEN }}

    steps:
      - name: Checkout Target Repository
        uses: actions/checkout@v4.1.1
        with:
          fetch-depth: 0

      - name: Generate Git Diff
        uses: GrantBirki/git-diff-action@v2.4.0
        id: git-diff
        with:
          raw_diff_file_output: diff.txt
          file_output_only: 'true'
          diff_filter: 'ACMR'
          diff_exclude: 'yarn.lock,package-lock.json'

      - name: Checkout GPT-Review Action
        uses: actions/checkout@v4.1.1
        with:
          repository: duyducpm0120/gpt-review-action
          ref: 0.0.4-alpha.11
          path: gpt-review-action

      - name: Install Dependencies
        run: yarn install
        working-directory: gpt-review-action

      - name: Build Project
        run: yarn build
        working-directory: gpt-review-action

      - name: Run GPT-4 Code Review
        uses: ./gpt-review-action
        with:
          diff-file-path: diff.txt
          openai-api-key: ${{ secrets.OPENAI_API_KEY }}
          github-token: ${{ secrets.AUTO_REVIEW_CODE_TOKEN }}
          prompt: ${{ vars.CODE_REVIEW_PROMPT }}
          model: 'gpt-4o'
```

## Setting Up Secrets & Variables
1. **GitHub Secrets**:
   - Go to your repository **Settings** > **Secrets and variables** > **Actions**.
   - Add the following secrets:
     - `AUTO_REVIEW_CODE_TOKEN`: GitHub token with `write` permission for issues and pull requests.
     - `OPENAI_API_KEY`: OpenAI GPT-4 API key.

2. **GitHub Variables**:
   - Under **Settings** > **Secrets and variables** > **Actions** > **Variables**, add:
     - `CODE_REVIEW_PROMPT`: 
       ```text
       Ki·ªÉm tra Git diff c·ªßa TypeScript module, t·∫≠p trung v√†o exposed secrets, performance inefficiencies, code readability, code smells, v√† clean code violations. ƒê·∫£m b·∫£o tu√¢n th·ªß TypeScript best practices...
       ```

## Workflow Behavior
- **Triggers**: Runs on `pull_request` events.
- **Outputs**: Comments on pull requests with actionable insights generated by GPT-4.
- **Exclusions**: Ignores files like `yarn.lock` or `package-lock.json`.

## Permissions
Ensure the following permissions are set for the GitHub Action:
```yaml
permissions:
  contents: read
  issues: write
  pull-requests: write
```

## License
This project is licensed under the **MIT License**. See the [LICENSE](LICENSE) file for details.

## Support
For issues or suggestions, please open an [issue](https://github.com/duyducpm0120/gpt-review-action/issues).

---

**Happy Reviewing üöÄ!**
